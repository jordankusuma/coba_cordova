{
    "sourceFile": "www/info9/login.php",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 32,
            "patches": [
                {
                    "date": 1644486229682,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1644486238439,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,2 +1,3 @@\n <?php \r\n-require_once \"connect.php\"\n\\ No newline at end of file\n+\r\n+require_once \"connect.php\";\r\n"
                },
                {
                    "date": 1644486243694,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,3 +1,4 @@\n <?php \r\n \r\n require_once \"connect.php\";\r\n+require_once\n\\ No newline at end of file\n"
                },
                {
                    "date": 1644486267172,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,4 +1,5 @@\n <?php \r\n \r\n require_once \"connect.php\";\r\n-require_once\n\\ No newline at end of file\n+\r\n+header(\"Access-Control-Allow-Origin: *\");\r\n"
                },
                {
                    "date": 1644486291201,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -2,4 +2,5 @@\n \r\n require_once \"connect.php\";\r\n \r\n header(\"Access-Control-Allow-Origin: *\");\r\n+header(\"Access-Control-Allow-Methods: POST\");\n\\ No newline at end of file\n"
                },
                {
                    "date": 1644486308057,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -2,5 +2,7 @@\n \r\n require_once \"connect.php\";\r\n \r\n header(\"Access-Control-Allow-Origin: *\");\r\n-header(\"Access-Control-Allow-Methods: POST\");\n\\ No newline at end of file\n+header(\"Access-Control-Allow-Methods: POST\");\r\n+\r\n+if ($_SERVER['REQUEST_METHOD'])\n\\ No newline at end of file\n"
                },
                {
                    "date": 1644486315045,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -4,5 +4,7 @@\n \r\n header(\"Access-Control-Allow-Origin: *\");\r\n header(\"Access-Control-Allow-Methods: POST\");\r\n \r\n-if ($_SERVER['REQUEST_METHOD'])\n\\ No newline at end of file\n+if ($_SERVER['REQUEST_METHOD'] === \"POST\") {\r\n+    \r\n+}\n\\ No newline at end of file\n"
                },
                {
                    "date": 1644486327313,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -5,6 +5,6 @@\n header(\"Access-Control-Allow-Origin: *\");\r\n header(\"Access-Control-Allow-Methods: POST\");\r\n \r\n if ($_SERVER['REQUEST_METHOD'] === \"POST\") {\r\n-    \r\n+    $data = json_decode()\r\n }\n\\ No newline at end of file\n"
                },
                {
                    "date": 1644486332563,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -5,6 +5,6 @@\n header(\"Access-Control-Allow-Origin: *\");\r\n header(\"Access-Control-Allow-Methods: POST\");\r\n \r\n if ($_SERVER['REQUEST_METHOD'] === \"POST\") {\r\n-    $data = json_decode()\r\n+    $data = json_decode(file_get_contents())\r\n }\n\\ No newline at end of file\n"
                },
                {
                    "date": 1644486344525,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -5,6 +5,7 @@\n header(\"Access-Control-Allow-Origin: *\");\r\n header(\"Access-Control-Allow-Methods: POST\");\r\n \r\n if ($_SERVER['REQUEST_METHOD'] === \"POST\") {\r\n-    $data = json_decode(file_get_contents())\r\n+    $data = json_decode(file_get_contents(\"php://input\", true));\r\n+    \r\n }\n\\ No newline at end of file\n"
                },
                {
                    "date": 1644486349804,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -6,6 +6,7 @@\n header(\"Access-Control-Allow-Methods: POST\");\r\n \r\n if ($_SERVER['REQUEST_METHOD'] === \"POST\") {\r\n     $data = json_decode(file_get_contents(\"php://input\", true));\r\n+    echo $data;\r\n     \r\n }\n\\ No newline at end of file\n"
                },
                {
                    "date": 1644486379961,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -7,6 +7,7 @@\n \r\n if ($_SERVER['REQUEST_METHOD'] === \"POST\") {\r\n     $data = json_decode(file_get_contents(\"php://input\", true));\r\n     echo $data;\r\n-    \r\n+\r\n+    $sql = \"SELECT * FROM user where username = '\". .  \"'\"\r\n }\n\\ No newline at end of file\n"
                },
                {
                    "date": 1644486395449,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -8,6 +8,6 @@\n if ($_SERVER['REQUEST_METHOD'] === \"POST\") {\r\n     $data = json_decode(file_get_contents(\"php://input\", true));\r\n     echo $data;\r\n \r\n-    $sql = \"SELECT * FROM user where username = '\". .  \"'\"\r\n+    $sql = \"SELECT * FROM user where username = '\".mysqli_real_escape_string().\"'\"\r\n }\n\\ No newline at end of file\n"
                },
                {
                    "date": 1644486415206,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -8,6 +8,6 @@\n if ($_SERVER['REQUEST_METHOD'] === \"POST\") {\r\n     $data = json_decode(file_get_contents(\"php://input\", true));\r\n     echo $data;\r\n \r\n-    $sql = \"SELECT * FROM user where username = '\".mysqli_real_escape_string().\"'\"\r\n+    $sql = \"SELECT * FROM user where username = '\".mysqli_real_escape_string($conn, $data->username).\"'\"\r\n }\n\\ No newline at end of file\n"
                },
                {
                    "date": 1644486484916,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -8,6 +8,7 @@\n if ($_SERVER['REQUEST_METHOD'] === \"POST\") {\r\n     $data = json_decode(file_get_contents(\"php://input\", true));\r\n     echo $data;\r\n \r\n-    $sql = \"SELECT * FROM user where username = '\".mysqli_real_escape_string($conn, $data->username).\"'\"\r\n+    $sql = \"SELECT * FROM user where username = '\".mysqli_real_escape_string($conn, $data->username).\"'\r\n+        AND password\"\r\n }\n\\ No newline at end of file\n"
                },
                {
                    "date": 1644486494859,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -9,6 +9,6 @@\n     $data = json_decode(file_get_contents(\"php://input\", true));\r\n     echo $data;\r\n \r\n     $sql = \"SELECT * FROM user where username = '\".mysqli_real_escape_string($conn, $data->username).\"'\r\n-        AND password\"\r\n+        AND password = '\". .\"'\"\r\n }\n\\ No newline at end of file\n"
                },
                {
                    "date": 1644486502398,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -9,6 +9,6 @@\n     $data = json_decode(file_get_contents(\"php://input\", true));\r\n     echo $data;\r\n \r\n     $sql = \"SELECT * FROM user where username = '\".mysqli_real_escape_string($conn, $data->username).\"'\r\n-        AND password = '\". .\"'\"\r\n+        AND password = '\".mysqli_real_escape_string($conn, $data->username).\"'\"\r\n }\n\\ No newline at end of file\n"
                },
                {
                    "date": 1644486510466,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -9,6 +9,8 @@\n     $data = json_decode(file_get_contents(\"php://input\", true));\r\n     echo $data;\r\n \r\n     $sql = \"SELECT * FROM user where username = '\".mysqli_real_escape_string($conn, $data->username).\"'\r\n-        AND password = '\".mysqli_real_escape_string($conn, $data->username).\"'\"\r\n+        AND password = '\".mysqli_real_escape_string($conn, $data->password).\"'\";\r\n+\r\n+        \r\n }\n\\ No newline at end of file\n"
                },
                {
                    "date": 1644486525032,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -11,6 +11,6 @@\n \r\n     $sql = \"SELECT * FROM user where username = '\".mysqli_real_escape_string($conn, $data->username).\"'\r\n         AND password = '\".mysqli_real_escape_string($conn, $data->password).\"'\";\r\n \r\n-        \r\n+    $result = mysqli_query($conn, $sql);\r\n }\n\\ No newline at end of file\n"
                },
                {
                    "date": 1644486547870,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -10,7 +10,12 @@\n     echo $data;\r\n \r\n     $sql = \"SELECT * FROM user where username = '\".mysqli_real_escape_string($conn, $data->username).\"'\r\n         AND password = '\".mysqli_real_escape_string($conn, $data->password).\"'\";\r\n+    $result = mysqli_query($conn, $sql);\r\n \r\n-    $result = mysqli_query($conn, $sql);\r\n+    if (mysqli_num_rows($result) < 1) {\r\n+\r\n+    } else {\r\n+        \r\n+    }\r\n }\n\\ No newline at end of file\n"
                },
                {
                    "date": 1644486566567,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -13,9 +13,9 @@\n         AND password = '\".mysqli_real_escape_string($conn, $data->password).\"'\";\r\n     $result = mysqli_query($conn, $sql);\r\n \r\n     if (mysqli_num_rows($result) < 1) {\r\n-\r\n+        echo json_encode(array('error' => 'invalid error'));\r\n     } else {\r\n         \r\n     }\r\n }\n\\ No newline at end of file\n"
                },
                {
                    "date": 1644486583560,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -15,7 +15,8 @@\n \r\n     if (mysqli_num_rows($result) < 1) {\r\n         echo json_encode(array('error' => 'invalid error'));\r\n     } else {\r\n+        $row = mysqli_fetch_assoc($result);\r\n         \r\n     }\r\n }\n\\ No newline at end of file\n"
                },
                {
                    "date": 1644486595777,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -16,7 +16,8 @@\n     if (mysqli_num_rows($result) < 1) {\r\n         echo json_encode(array('error' => 'invalid error'));\r\n     } else {\r\n         $row = mysqli_fetch_assoc($result);\r\n+        $username = $row['username'];\r\n         \r\n     }\r\n }\n\\ No newline at end of file\n"
                },
                {
                    "date": 1644486628942,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -17,7 +17,8 @@\n         echo json_encode(array('error' => 'invalid error'));\r\n     } else {\r\n         $row = mysqli_fetch_assoc($result);\r\n         $username = $row['username'];\r\n+        $headers = array('alg'=>'HS256', 'typ'=>'JWT');\r\n         \r\n     }\r\n }\n\\ No newline at end of file\n"
                },
                {
                    "date": 1644486659615,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -18,7 +18,7 @@\n     } else {\r\n         $row = mysqli_fetch_assoc($result);\r\n         $username = $row['username'];\r\n         $headers = array('alg'=>'HS256', 'typ'=>'JWT');\r\n-        \r\n+        $payload = array('username' => $username, 'exp' => (time() + 60))''\r\n     }\r\n }\n\\ No newline at end of file\n"
                },
                {
                    "date": 1644486669625,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -18,7 +18,8 @@\n     } else {\r\n         $row = mysqli_fetch_assoc($result);\r\n         $username = $row['username'];\r\n         $headers = array('alg'=>'HS256', 'typ'=>'JWT');\r\n-        $payload = array('username' => $username, 'exp' => (time() + 60))''\r\n+        $payload = array('username' => $username, 'exp' => (time() + 60));\r\n+        $jwt = \r\n     }\r\n }\n\\ No newline at end of file\n"
                },
                {
                    "date": 1644486680748,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -19,7 +19,7 @@\n         $row = mysqli_fetch_assoc($result);\r\n         $username = $row['username'];\r\n         $headers = array('alg'=>'HS256', 'typ'=>'JWT');\r\n         $payload = array('username' => $username, 'exp' => (time() + 60));\r\n-        $jwt = \r\n+        $jwt = generate_jwt()\r\n     }\r\n }\n\\ No newline at end of file\n"
                },
                {
                    "date": 1644486686805,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -19,7 +19,7 @@\n         $row = mysqli_fetch_assoc($result);\r\n         $username = $row['username'];\r\n         $headers = array('alg'=>'HS256', 'typ'=>'JWT');\r\n         $payload = array('username' => $username, 'exp' => (time() + 60));\r\n-        $jwt = generate_jwt()\r\n+        $jwt = generate_jwt($headers, $payload);\r\n     }\r\n }\n\\ No newline at end of file\n"
                },
                {
                    "date": 1644486705391,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -20,6 +20,7 @@\n         $username = $row['username'];\r\n         $headers = array('alg'=>'HS256', 'typ'=>'JWT');\r\n         $payload = array('username' => $username, 'exp' => (time() + 60));\r\n         $jwt = generate_jwt($headers, $payload);\r\n+        echo json_encode(array())\r\n     }\r\n }\n\\ No newline at end of file\n"
                },
                {
                    "date": 1644486711964,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -20,7 +20,7 @@\n         $username = $row['username'];\r\n         $headers = array('alg'=>'HS256', 'typ'=>'JWT');\r\n         $payload = array('username' => $username, 'exp' => (time() + 60));\r\n         $jwt = generate_jwt($headers, $payload);\r\n-        echo json_encode(array())\r\n+        echo json_encode(array('token' => $jwt));\r\n     }\r\n }\n\\ No newline at end of file\n"
                },
                {
                    "date": 1644486752208,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -4,8 +4,21 @@\n \r\n header(\"Access-Control-Allow-Origin: *\");\r\n header(\"Access-Control-Allow-Methods: POST\");\r\n \r\n+function generate_jwt($headers, $payload, $secret = 'secret') {\r\n+\t$headers_encoded = base64url_encode(json_encode($headers));\r\n+\t\r\n+\t$payload_encoded = base64url_encode(json_encode($payload));\r\n+\t\r\n+\t$signature = hash_hmac('SHA256', \"$headers_encoded.$payload_encoded\", $secret, true);\r\n+\t$signature_encoded = base64url_encode($signature);\r\n+\t\r\n+\t$jwt = \"$headers_encoded.$payload_encoded.$signature_encoded\";\r\n+\t\r\n+\treturn $jwt;\r\n+}\r\n+\r\n if ($_SERVER['REQUEST_METHOD'] === \"POST\") {\r\n     $data = json_decode(file_get_contents(\"php://input\", true));\r\n     echo $data;\r\n \r\n"
                },
                {
                    "date": 1644486767612,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -4,8 +4,12 @@\n \r\n header(\"Access-Control-Allow-Origin: *\");\r\n header(\"Access-Control-Allow-Methods: POST\");\r\n \r\n+function base64url_encode($str) {\r\n+    return rtrim(strtr(base64_encode($str), '+/', '-_'), '=');\r\n+}\r\n+\r\n function generate_jwt($headers, $payload, $secret = 'secret') {\r\n \t$headers_encoded = base64url_encode(json_encode($headers));\r\n \t\r\n \t$payload_encoded = base64url_encode(json_encode($payload));\r\n"
                },
                {
                    "date": 1644487042786,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -23,9 +23,8 @@\n }\r\n \r\n if ($_SERVER['REQUEST_METHOD'] === \"POST\") {\r\n     $data = json_decode(file_get_contents(\"php://input\", true));\r\n-    echo $data;\r\n \r\n     $sql = \"SELECT * FROM user where username = '\".mysqli_real_escape_string($conn, $data->username).\"'\r\n         AND password = '\".mysqli_real_escape_string($conn, $data->password).\"'\";\r\n     $result = mysqli_query($conn, $sql);\r\n"
                }
            ],
            "date": 1644486229682,
            "name": "Commit-0",
            "content": "<?php \r\nrequire_once \"connect.php\""
        }
    ]
}